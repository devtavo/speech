
<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta http-equiv="Last-Modified" content="-1">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <!-- Latest compiled and minified JavaScript --> 
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>        <script src='https://code.responsivevoice.org/responsivevoice.js'></script>
        <script language="javascript" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.8.0/p5.js"></script>
        <script language="javascript" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.8.0/addons/p5.dom.js"></script>
        <script language="javascript" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.8.0/addons/p5.sound.js"></script>
        <script src="js/p5speech.js" type="text/javascript"></script>
        <title>Voice live</title>
    </head>
    <style>
        #caption {
            position: relative;
            width: 100%;
            bottom: 0;
            bottom:30px; /* space for the video controls */
            left: 0;
            text-align: center;
            font-family: sans-serif;
            font-weight: bold;
            color: white;
            text-shadow: black 1px 1px 3px;
            padding-bottom: .5em;
        }
        #transcript span {display:table-row;}
        #transcript [data-begin]:before{
            content: " [" attr(data-begin) "s-" attr(data-end)"s]   ";
            font-size:80%;
            display:table-cell;
            padding-right:1em;
        }
    </style>
    <body  >
        <video width=600 src="video/caja de cambios.mp4" ontimeupdate="timeupdate()"
               style="background:black" autobuffer controls>
            <p>This page is to demonstrate open HTML5 video, so if you're not using a
                browser that can display the open Ogg Theora codec, there's not  much to see. Sorry!</p>
        </video>
        <div id="transcript">
            <h3>Transcript</h3>
            <p>
                <span data-begin=1 data-end=6>Hi, my name's Dr Archimedes Einstein and I'm a Doctor of Science at the University of Science</span>
                <span data-begin=6 data-end=9>in a very famous town that you're too stupid to have heard of.</span>
                <span data-begin=9.5 data-end=11.5>Anyway, today we're going to talk about "synergies".</span>
                <span data-begin=12 data-end=15>A lot of people are worried about synergies, but I can tell you that</span>
                <!-- ... -->
            </p>
        </div>

        <script>
            var captions = [];
            window.onload = function () {
                //creamos el div
                var caption = document.createElement('div');
                caption.id = 'caption';
                // Cargamos el primer elemento
                var ref = document.getElementsByTagName('video')[0];
                ref.parentNode.insertBefore(caption, ref.nextSibling);

                // Cargamos todos los subtítulos
                var nodes = document.querySelectorAll('#transcript span');
                for (var i = 0; i < nodes.length; i++) {
                    // Generamos un objeto con la información de cada línea
                    var c = {
                        'start': parseFloat(nodes[i].getAttribute('data-begin')),
                        'end': parseFloat(nodes[i].getAttribute('data-end')),
                        'text': nodes[i].textContent
                    };
                    console.log(c);
                    captions.push(c);

                }
            };
// Función que actualizar el texto dependiendo del tiempo
            function timeupdate() {
                var v = document.querySelector('video');
                var now = v.currentTime;
                    var too=hora(now);
                console.log(too);
                var tt = typeof now;
//                console.log(tt);
//                console.log(now);
                var text = "";
                for (var i = 0; i < captions.length; i++) {
                    if (now >= captions[i].start && now <= captions[i].end)
                    {
                        text = captions[i].text;
                        break;
                    }
                }
                document.getElementById('caption').innerHTML = text;
            }
            
            function hora(segundos) {
                var d = new Date(segundos * 1000);
                //console.log(d);
                // Ajuste de las 23 horas
                //var hora = (d.getHours() === 0) ? 23 : d.getHours() - 1;
               var hora=00;
                //var hora2 = (hora < 9) ? "0" + hora : hora;
                var minuto = (d.getMinutes() < 9) ? "0" + d.getMinutes() : d.getMinutes();
                var segundo = (d.getSeconds() < 9) ? "0" + d.getSeconds() : d.getSeconds();
                var mili=(d.getMilliseconds() < 99) ? "00" + d.getMilliseconds() : d.getMilliseconds();
                return hora + ":" + minuto + ":" + segundo + "," + mili;
            }
// Ocultamos los subtítulos
            document.write('<style>#transcript{display:none}</style>');
        </script>
    </body>
</html>
